!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("ARTE",[],t):"object"==typeof exports?exports.ARTE=t():e.ARTE=t()}(self,(function(){return(()=>{"use strict";var e={250:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(333),o=n(609),a=null,i=function(e,t){(a=document.createElement("DIV")).classList.add("modal-panel"),a.innerHTML=function(e,t){return'\n        <div class="modal-panel-container">\n            <header class="modal-panel-header">\n                <h3 class="modal-panel-title">'.concat(e,'</h3>\n            </header>\n            <div class="modal-panel-message">').concat(t,'</div>\n            <div class="modal-panel-buttons">\n                <button type="button" class="btn btn-success close">Close</button>\n            </div>\n        </div>')}(e,t),a.querySelector("button").addEventListener("click",(function(e){e.stopPropagation(),a.classList.remove("show"),setTimeout((function(){a.remove(),a=null}),500)})),document.querySelector("body").appendChild(a),setTimeout((function(){a.classList.add("show")}),10)};function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const s=function(){function e(t,n,r,o){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=this.initOptions(o),this.initBuffering(n),this.toolbar=this.initToolbar(r),t.innerHTML=function(e,t){var n=function(e){var t="",n=[];return e.forEach((function(r,o){t+=function(e){var t=e.type,n=e.tag,r=e.label,o=e.icon;return'\n        <button id="'.concat(n,'" type="button" class="btn btn-light ').concat(t,'" title="').concat(r,'">\n            ').concat(o,"\n        </button>")}(r);var a=o==e.length-1?"":e[o+1].group;if(r.group!=a){var i="".concat(r.group," buttons");n.push(function(e,t){return'<div class="editor-toolbar-group block" role="group" title="'.concat(e,'">').concat(t,"</div>")}(i,t)),t=""}})),n.join('<span class="editor-toolbar-group-separator">|</span>')}(e),r="";return"on"==t.headingNumbers&&(r+="heading-numbers"),'\n        <div class="editor-container">\n            <div class="editor-toolbar">\n                '.concat(n,'\n            </div>\n            <div class="editor-body ').concat(r,'" contenteditable="true">\n                ...\n            </div>\n        </div>')}(this.toolbar,this.options),this.editorNode=t.querySelector(".editor-body"),this.toolbarNode=t.querySelector(".editor-toolbar"),this.editorNode.innerHTML=n,this.range=!1,this.listenForMouseUpEvents(),this.listenForPasteEvents(),this.listenForKeydownEvents(),this.initialiseButtons(),this.options.bufferSize>0&&(this.bufferIndex=0,this.buffer=[this.editorNode.innerHTML],this.listenForKeyupEvents()),this.save=this.getCleanData,this.update=this.updateEditor,new MutationObserver((function(){return a.handleMutation()})).observe(this.editorNode,{attributes:!1,childList:!0,subtree:!0})}var t,n;return t=e,(n=[{key:"handleMutation",value:function(){!1===this.bufferIgnoreMutation(this)&&(this.bufferUpdate(this),this.updateEventHandlers())}},{key:"initBuffering",value:function(){this.bufferIndex=-1,this.buffer=[],this.bufferIgnore=!1,this.bufferUpdate=o.update,this.bufferIgnoreMutation=o.ignore}},{key:"initOptions",value:function(e){return e?(e.headingNumbers=void 0!==e.headingNumbers?e.headingNumbers:"off",e.bufferSize=void 0!==e.bufferSize?Math.max(parseInt(e.bufferSize),10):10):e={headingNumbers:"off",bufferSize:10},e}},{key:"initToolbar",value:function(e){var t=[];return e.forEach((function(e,n){e.forEach((function(e){e.group=n,r.lv(e.type,e.tag),t.push(e)}))})),t}},{key:"setState",value:function(e){"setState"in e?e.setState(this,e):(!1===this.range?e.element.disabled=!0:e.element.disabled=!1,e.element.classList.remove("active"))}},{key:"initialiseButtons",value:function(){var e=this;this.shortcuts=[],this.toolbar.forEach((function(t){t.element=e.toolbarNode.querySelector("#".concat(t.tag)),"init"in t&&t.init(e,t),e.setState(t),"shortcut"in t&&(t.shortcut[0],t.shortcut[1],e.shortcuts.push({shortcut:t.shortcut[0],trigger:t.shortcut[1],button:t})),t.element.addEventListener("click",(function(n){!1!==e.range||"buffer"===t.type?t.click(e,t):n.preventDefault()}))}))}},{key:"listenForMouseUpEvents",value:function(){var e=this;document.addEventListener("mouseup",(function(t){if(e.nodeInEditor(t.target))e.handleMouseUp();else{if(e.nodeInToolbar(t.target))return;e.handleEditorBlur()}}))}},{key:"handleEditorBlur",value:function(e){var t=this;0==document.querySelectorAll(".show").length&&(console.log("editor blurred"),this.toolbar.forEach((function(e){t.range=!1,t.setState(e)})))}},{key:"nodeInEditor",value:function(e){for(;3==e.nodeType||"HTML"!=e.tagName;){if(e==this.editorNode)return!0;e=e.parentNode}return!1}},{key:"nodeInToolbar",value:function(e){for(;3==e.nodeType||"HTML"!=e.tagName;){if(e==this.toolbarNode)return!0;e=e.parentNode}return!1}},{key:"setToolbarStates",value:function(){var e=this;!1!==this.range?this.toolbar.forEach((function(t){e.setState(t)})):this.toolbar.forEach((function(e){e.element.classList.remove("active")}))}},{key:"handleMouseUp",value:function(){if(this.updateRange(),!1!==this.range){this.bufferIgnore=!1,this.range.blockParent==this.editorNode&&""==this.editorNode.innerText&&this.insertParagraph();var e=r.up(this.range);this.highlightCustomNode(e)}this.setToolbarStates()}},{key:"insertParagraph",value:function(){var e=document.createElement("P");e.innerText="\n",e=this.editorNode.appendChild(e),r.KJ(e,0)}},{key:"listenForKeydownEvents",value:function(){var e=this;this.lastKey="",this.editorNode.addEventListener("keydown",(function(t){var n,r=!1;console.log("control key?",t.ctrlKey),console.log("key",t.key),document.querySelectorAll(".show").length>0&&(t.preventDefault(),r=!0),r||"Enter"!=t.key||(e.handleEnter()&&t.preventDefault(),r=!0),!r&&("Backspace"==t.key||"Delete"==t.key||t.ctrlKey&&"d"==t.key)&&(e.handleDelete(t.key)&&t.preventDefault(),r=!0),r||e.shortcuts.forEach((function(n){e.lastKey===n.shortcut&&t.key===n.trigger&&(t.preventDefault(),t.stopPropagation(),n.button.click(e,n.button),r=!0)})),!r&&e.bufferSize>0&&(t.ctrlKey||t.metaKey)&&"z"==t.key&&(t.preventDefault(),n=t.shiftKey?e.toolbar.find((function(e){return"REDO"==e.tag})):e.toolbar.find((function(e){return"UNDO"==e.tag})),e.buffer.click(n),e.updateEventHandlers(),r=!0),e.lastKey=t.key}))}},{key:"handleEnter",value:function(){if(this.updateRange(),!1!==this.range){var e=r.up(this.range),t=this.range.endContainer.textContent.trim().length==this.range.endOffset,n=!1;if(e||t){console.log("Creating a ".concat(this.range.blockParent.tagName," node"));var o=document.createElement(this.range.blockParent.tagName);o.innerText="\n",o=r.BE(o,this.range.blockParent),r.KJ(o,0),n=!0}return e&&this.highlightCustomNode(!1),this.updateRange(),n}}},{key:"handleDelete",value:function(e){if("d"==e&&(e="Delete"),this.updateRange(),this.range){var t="Information",n="To delete a custom element you need to edit it by clicking it and choosing Delete.";if(this.range.collapsed){if(console.log("Single selection"),console.log("range length",this.range.endContainer.textContent.trim().length),console.log("range endOffset",this.range.endOffset),"Backspace"==e&&0==this.range.startOffset){var o=this.range.blockParent.previousElementSibling;if(o&&o.innerHTML.includes('contenteditable="false"'))return i(t,n),!0}else if("Delete"==e&&this.range.endContainer.textContent.trim().length==this.range.endOffset){console.log("Deleting from end container");var a=this.range.endContainer.nextElementSibling;if(console.log("next",a),a&&"false"==a.getAttribute("contenteditable"))return i(t,n),!0}}else for(var l=r.H_(this.range.startContainer),s=r.H_(this.range.endContainer);l!==s;){if(l.innerHTML.includes('contenteditable="false"'))return i(t,n),!0;l=l.nextElementSibling}}return!1}},{key:"listenForKeyupEvents",value:function(){var e=this;this.handleKeyup=r.Ds(this.handleKeyupDelayed,500),this.editorNode.addEventListener("keyup",(function(t){console.log("handle key up event",t),0==["Shift"].includes(t.key)&&(e.bufferIgnore=!0,e.handleKeyup(t.key,e))}))}},{key:"handleKeyupDelayed",value:function(){var e=["ArrowDown","ArrowUp","ArrowLeft","ArrowRight","End","Home"],t=arguments.length<=0?void 0:arguments[0],n=arguments.length<=1?void 0:arguments[1];e.includes(t)?(n.range=r.rx(),n.setToolbarStates()):0==document.querySelectorAll(".show").length&&n.bufferUpdate(n)}},{key:"updateEventHandlers",value:function(){var e=this;this.toolbar.forEach((function(t){"addEventHandlers"in t&&t.addEventHandlers(e)}))}},{key:"listenForPasteEvents",value:function(){var e=this;["cut","copy","paste"].forEach((function(t){return e.editorNode.addEventListener(t,(function(t){e.handleCutCopyPaste()&&t.preventDefault()}))}))}},{key:"handleCutCopyPaste",value:function(){if(console.log("Detected cut-copy-paste event"),this.updateRange(),0==this.range||this.range.collapsed)return!1;for(var e=r.H_(this.range.startContainer),t=r.H_(this.range.endContainer),n=!1;!n;){if(e.innerHTML.includes('contenteditable="false"'))return i("Information","Cut, copy and paste (of/over) selections with custom elements is not supported. Please modify your selection and try again."),!0;(e=e.nextElementSibling)===t&&(n=!0)}return!1}},{key:"getCleanData",value:function(){var e=this.editorNode.cloneNode(!0),t=this.toolbar.filter((function(e){return"custom"===e.type}));return r.gv(e,t),e.innerHTML=e.innerHTML.replace(/[\n ]*?</gm,"<"),e.innerHTML}},{key:"updateEditor",value:function(e){this.editorNode.innerHTML=e}},{key:"updateRange",value:function(){var e,t;this.range=r.rx(),e=this.range,null!=(t=document.getElementById("debug"))&&(t.innerHTML=!1===e?"No range selected":'\n            <h5>Selection info:</h5>\n            <div class="debug">\n                <div class="col">\n                    <label>Block parent</label><span>'.concat(e.blockParent.tagName,"</span>\n                    <label>commonAncestorC</label><span>").concat(e.commonAncestorContainer.tagName?e.commonAncestorContainer.tagName:e.commonAncestorContainer.textContent,"</span>\n                    <label>rootNode</label><span>").concat(e.rootNode.tagName,"</span>\n                    <label>collapsed</label><span>").concat(e.collapsed,'</span>\n                </div>\n                <div class="col">\n                    <label>startC</label><span>').concat(e.startContainer.tagName?e.startContainer.tagName:e.startContainer.textContent,"</span>\n                    <label>startOffset</label><span>").concat(e.startOffset,"</span>\n                    <label>endC</label><span>").concat(e.endContainer.tagName?e.endContainer.tagName:e.endContainer.textContent,"</span>\n                    <label>endOffset</label><span>").concat(e.endOffset,"</span>\n                </div>\n            </div>"))}},{key:"highlightCustomNode",value:function(e){this.editorNode.querySelectorAll("[contenteditable=false]").forEach((function(e){return e.classList.remove("selected")})),e&&e.classList.add("selected")}}])&&l(t.prototype,n),e}()},208:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function e(t,n,r,o,a,i){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.tag=n,this.label=r,this.input="button",this.icon=o,this.click=a,this.element=null,null!=i&&Object.keys(i).forEach((function(e){l[e]=i[e]}))}},333:(e,t,n)=>{n.d(t,{cO:()=>r,fA:()=>o,BE:()=>a,$H:()=>i,lv:()=>s,Qc:()=>c,nq:()=>u,Lq:()=>d,up:()=>f,UK:()=>p,kg:()=>b,H_:()=>h,GC:()=>g,gv:()=>m,xK:()=>v,rx:()=>C,KJ:()=>E,E:()=>L,Kj:()=>S,Mt:()=>A,Ds:()=>H,y_:()=>q});var r=function(e,t){return(0==e.length||0==t.length||e.length==t.length)&&e.every((function(e,n){return t[n]==e}))},o=function(e,t){return e.every((function(e,n){return t[n]==e}))},a=function(e,t){return t.parentNode.insertBefore(e,t.nextSibling)},i=function(e,t,n){var r=document.createElement(t);r.innerHTML=n;var o=e.parentNode.insertBefore(r,e);return e.parentNode.removeChild(e),o},l={block:["DIV","P","LI"],list:["LI"],custom:[]},s=function(e,t){null!=l[e]&&0==l[e].includes(t)&&"CLEAR"!=t&&l[e].push(t)},c=function(e){return null!=e.tagName&&"SPAN"===e.tagName},u=function(e){return void 0!==e.tagName&&("OL"===e.tagName||"UL"===e.tagName)},d=function(e){return null!=e.tagName&&l.block.includes(e.tagName)},f=function(e){var t=e.blockParent.firstElementChild;return!(null==t||!p(t))&&t},p=function(e){return null!=e.tagName&&l.custom.includes(e.tagName)},b=function(e){for(var t="";0==d(e);){if(1===e.nodeType){var n=e.getAttribute("style");null!=n&&""!=n&&(t+=";"+n)}e=e.parentNode}return t},h=function(e){for(;0==d(e);)e=e.parentNode;return e},g=function(e,t){for(var n=e;e!=t;)n=e,e=e.parentNode;return n},m=function e(t,n){if(3!==t.nodeType)if(1===t.nodeType)if(!1!==d(t)||!1!==u(t)||!1!==c(t)||!1!==p(t))if(n.length>0&&p(t)){var r=n.find((function(e){return e.tag.toUpperCase()===t.tagName}));if(r&&"clean"in r){var o=r.clean(t);t.parentNode.replaceChild(o,t)}}else t.childNodes.forEach((function(t){e(t,n)}));else t.remove();else t.remove();else t.textContent.includes("\n")&&(t.textContent=t.textContent.trim())},v=function(e){e.startContainer==e.endContainer?e.startContainer.textContent=e.startContainer.textContent.substring(0,e.startOffset)+L+e.startContainer.textContent.substring(e.startOffset,e.endOffset)+S+e.startContainer.textContent.substring(e.endOffset):(e.startContainer.textContent=e.startContainer.textContent.substring(0,e.startOffset)+L+e.startContainer.textContent.substring(e.startOffset),e.endContainer.textContent=e.endContainer.textContent.substring(0,e.endOffset)+S+e.endContainer.textContent.substring(e.endOffset))};function y(e){return e.blockParent=h(e.commonAncestorContainer),e.rootNode=e.commonAncestorContainer,3===e.commonAncestorContainer.nodeType&&(e.rootNode=e.commonAncestorContainer.parentNode),e}var C=function(){if(null===document.querySelector(".show")){var e=window.getSelection();if(1==e.rangeCount){var t=e.getRangeAt(0);return y(t)}}return!1},E=function(e,t){var n=document.createRange(),r=window.getSelection();return t>e.textContent.length&&(t=0),n.setStart(e,t),n.collapse(!0),r.removeAllRanges(),r.addRange(n),y(n)},L="§§",S="±±",N=null,k=0,x=null,T=0;function w(e,t){for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];if(1===r.nodeType){if(w(r,t))return!0}else if(3===r.nodeType){var o=r.textContent.indexOf(t);if(-1!=o)return r.textContent=r.textContent.replace(t,""),t==L?(N=r,k=o):(x=r,T=o),!0}}return!1}var A=function(e){if(w(e,L)&&w(e,S)){var t=document.createRange(),n=window.getSelection();return t.setStart(N,k),N==x&&k==T?t.collapse(!0):t.setEnd(x,T),n.removeAllRanges(),n.addRange(t),t}return!1},H=function(e,t){var n;return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];n&&clearTimeout(n),n=setTimeout((function(){e.apply(void 0,o)}),t)}},q=function(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}},92:(e,t,n)=>{n.d(t,{h1:()=>r,h2:()=>o,h3:()=>a,p:()=>i,bq:()=>l,ol:()=>s,ul:()=>c,b:()=>u,i:()=>d,u:()=>f,ZH:()=>p,Yw:()=>b,KX:()=>h,lB:()=>g,p4:()=>m,El:()=>v,si:()=>y,BA:()=>C,nG:()=>E});var r='<i class="bi bi-type-h1"></i>',o='<i class="bi bi-type-h2"></i>',a='<i class="bi bi-type-h3"></i>',i='<i class="bi bi-paragraph"></i>',l='<i class="bi bi-blockquote-left"></i>',s='<i class="bi bi-list-ol"></i>',c='<i class="bi bi-list-ul"></i>',u='<i class="bi bi-type-bold"></i>',d='<i class="bi bi-type-italic"></i>',f='<i class="bi bi-type-underline"></i>',p='<i class="bi bi-eraser"></i>',b='<i class="bi bi-reply"></i>',h='<span  style="display:inline-block;-webkit-transform: scale(-1, 1);transform: scale(-1, 1);"><i class="bi bi-reply"></i></span>',g='<i class="bi bi-person"></i>',m='<i class="bi bi-link"></i>',v='<i class="bi bi-type"></i>',y='<i class="bi bi-paint-bucket"></i>',C='<i class="bi bi-plug"></i>',E='<i class="bi bi-link-45deg"></i>'},135:(e,t,n)=>{n.d(t,{C:()=>o,$:()=>a});var r=null,o=function(){r.classList.remove("show"),setTimeout((function(){r.remove(),r=null}),500)},a=function(e,t,n,a){return null==n&&(n="No - stay here"),null==a&&(a="Yes - lose changes"),(r=document.createElement("DIV")).classList.add("modal-panel"),r.innerHTML=function(e,t,n,r){return null==n&&(n="No - stay here"),null==r&&(r="Yes - lose changes"),'\n        <div class="modal-panel-container">\n            <header class="modal-panel-header">\n                <h3 class="modal-panel-title">'.concat(e,'</h3>\n            </header>\n            <div class="modal-panel-message">').concat(t,'</div>\n            <div class="modal-panel-buttons">\n                <button type="button" class="cancel">').concat(n,'</button>\n                <button type="button" class="confirm">').concat(r,"</button>\n            </div>\n        </div>")}(e,t,n,a),r.querySelector("button.cancel").addEventListener("click",(function(e){e.stopPropagation(),o()})),document.querySelector("body").appendChild(r),setTimeout((function(){r.classList.add("show")}),10),r.querySelector("button.confirm")}},124:(e,t,n)=>{n.d(t,{S1:()=>l,t8:()=>s,hF:()=>c,Ps:()=>u,Hk:()=>d,Z$:()=>f,Q9:()=>p,v_:()=>b});var r,o,a=n(333),i="",l=function(e,t){r=e.startContainer,o=e.endContainer,t&&(r=a.H_(r),o=a.H_(o)),i="pre"},s=function(e){e==r?(i="first",e==o&&(i="both")):e==o?i="last":"first"==i?i="during":"both"==i||"last"==i?i="post-first":"post-first"==i&&(i="post")},c=function(){return"pre"==i},u=function(){return"first"==i||"both"==i},d=function(){return"both"==i},f=function(){return"last"==i},p=function(){return"during"==i||"first"==i||"last"==i||"both"==i},b=function(){return"post-first"==i||"post"==i}},326:(e,t,n)=>{n.r(t),n.d(t,{H1:()=>E,H2:()=>L,H3:()=>S,P:()=>N,BQ:()=>k,OL:()=>x,UL:()=>T});var r,o,a,i=n(333),l=n(124),s=n(92),c=n(208);function u(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f,p="",b="",h="",g=[],m=!1;function v(e,t){var n={oldFormats:[],newFormats:[]};e!=r&&(l.t8(e),function(e,t){var n,r=f,o=function(e){var t="";return e.childNodes.forEach((function(e){if(3===e.nodeType){var n=e.textContent;n.includes("\n")&&(n=n.trim()),t+=n}else(i.Qc(e)||i.UK(e)||"BR"===e.tagName)&&(t+=e.outerHTML)})),t}(e),a=[],s=(a=l.Q9()?t.newFormats:t.oldFormats).slice(-1)[0];if(e.nodeType,!(1!==e.nodeType||""==o&&e.innerHTML.includes("<"))){if(0==g.length)a.forEach((function(e){n=document.createElement(e),r=r.appendChild(n)}));else if(a.length>g.length){if(console.log("saveContent: 2. Current formats longer than previous formats"),i.fA(g,a)){for(var c=0;c<g.length;c++)r=r.lastElementChild;for(var u=g.length;u<a.length;u++)n=document.createElement(a[u]),r=r.appendChild(n)}}else i.cO(a,g)&&(m&&m!=f&&(r=m.parentNode),n=document.createElement(s),r=r.appendChild(n));if(r==f){var d=0;a.forEach((function(e,t){e==g[t]&&0==(t==a.length-1&&"LI"==e)&&(r=r.lastElementChild,d++)}));for(var p=d;p<a.length;p++)n=document.createElement(a[p]),r=r.appendChild(n)}m=r,g=a.slice(),""!=o&&(r.innerHTML=o)}}(e,n=function(e,t){var n=[].concat(u(t.oldFormats),[e.tagName]),r=[];return l.hF()||l.v_()?{newFormats:r=u(n),oldFormats:n}:"block"===p?{newFormats:r=[h],oldFormats:n}:l.Ps()?("LI"==e.tagName?e.parentNode.firstElementChild==e?(r.pop(),r.push(h),r.push("LI"),console.log("3.1.2 new list formats",t.newFormats.join(" "))):((r=t.oldFormats.slice()).push(h),r.push("LI"),console.log("3.1.4 new list formats",t.newFormats.join(" "))):(r.push(h),r.push("LI")),{newFormats:r,oldFormats:n}):{newFormats:r=g.slice(),oldFormats:n}}(e,t))),e.childNodes.forEach((function(e){(i.Lq(e)||i.nq(e))&&v(e,n)}))}var y=function(e,t){r=e.editorNode,o=e.range,p=(a=t).type,b="apply",("CLEAR"==a.tag||a.element.getAttribute("data-active"))&&(b="remove"),h=a.tag,"block"==a.type&&"remove"==b&&(h="P"),g=[],m=!1,o.rootNode=i.GC(o.rootNode,r);var n=i.GC(o.startContainer,r),s=i.GC(o.endContainer,r);if(i.xK(e.range),l.S1(o,!0),n==s)f=document.createElement("DIV"),v(n,{oldFormats:[],newFormats:[]}),n==r?n.innerHTML=f.innerHTML:n.outerHTML=f.innerHTML;else{var c=!1,u=!1;f=document.createElement("DIV"),o.rootNode.childNodes.forEach((function(e){1===e.nodeType&&(e==n&&(c=!0),c&&0==u&&("block"==p&&(g=[],m=!1,f=document.createElement("DIV")),v(e,{oldFormats:[],newFormats:[]}),"block"==p?e.outerHTML=f.innerHTML:e.setAttribute("data-remove",!0)),e==s&&(u=!0,"list"==p&&(console.log("fragment",f.innerHTML),e.outerHTML=f.innerHTML),r.querySelectorAll("[data-remove=true]").forEach((function(e){return e.remove()}))))}))}i.Mt(e.editorNode),e.updateRange(),a.setState(e,a)},C={setState:function(e,t){if(!1===e.range)t.element.disabled=!0,t.element.classList.remove("active");else if("CLEAR"==t.tag)t.element.disabled=!1,t.element.classList.remove("active");else{var n=i.H_(e.range.startContainer,e.editorNode);t.element.disabled="DIV"===n.tagName||i.UK(n),"list"===t.type&&"LI"===n.tagName&&(n=n.parentNode),n.tagName===t.tag?t.element.classList.add("active"):t.element.classList.remove("active")}}},E=new c.Z("block","H1","Heading 1",s.h1,y,C),L=new c.Z("block","H2","Heading 2",s.h2,y,C),S=new c.Z("block","H3","Heading 3",s.h3,y,C),N=new c.Z("block","P","Paragraph",s.p,y,C),k=new c.Z("block","BLOCKQUOTE","Blockquote",s.bq,y,C),x=new c.Z("list","OL","Ordered list",s.ol,y,C),T=new c.Z("list","UL","Unordered list",s.ul,y,C)},609:(e,t,n)=>{n.r(t),n.d(t,{update:()=>i,ignore:()=>l,UNDO:()=>c,REDO:()=>u});var r=n(92),o=n(208),a=function(e,t){"UNDO"==t.tag?t.element.disabled=e.buffer.length<=1||e.bufferIndex<=0:t.element.disabled=e.bufferIndex>=e.buffer.length-1},i=function(e){if(0!=e.options.bufferSize){if(e.buffer.length>e.options.bufferSize&&e.buffer.shift(),e.bufferIndex+1<e.buffer.length)for(var t=e.buffer.length-(e.bufferIndex+1),n=0;n<t;n++)e.buffer.pop();e.buffer.push(e.editorNode.innerHTML),e.bufferIndex=e.buffer.length-1,a(e,c),a(e,u)}},l=function(e){var t=e.bufferIgnore;return e.bufferIgnore=!1,t},s={setState:a},c=new o.Z("buffer","UNDO","Undo",r.Yw,(function(e){e.bufferIndex>0&&(e.bufferIndex--,e.bufferIgnore=!0,e.editorNode.innerHTML=e.buffer[e.bufferIndex]),a(e,c),a(e,u),console.log("buffer",e.buffer),console.log("buffer index",e.bufferIndex),e.updateEventHandlers()}),s),u=new o.Z("buffer","REDO","Redo",r.KX,(function(e){e.bufferIndex+1<e.buffer.length&&(e.bufferIndex++,e.bufferIgnore=!0,e.editorNode.innerHTML=e.buffer[e.bufferIndex]),a(e,c),a(e,u),console.log("buffer",e.buffer),console.log("buffer index",e.bufferIndex),e.updateEventHandlers()}),s)},626:(e,t,n)=>{n.r(t),n.d(t,{FOREGROUND:()=>f,BACKGROUND:()=>p});var r,o,a=n(333),i=n(178),l=n(92),s=n(208);var c=function(e,t){!1===e.range||e.range.collapsed?console.log("No non-collapsed range selected"):function(e,t){(o=document.createElement("input")).type="color",o.style="display:none;",document.body.appendChild(o),o.click(),o.addEventListener("input",(function(n){console.log("colour changed",n.target.value);var r=n.target.value,a={setState:u,style:"".concat(t.style,":").concat(r),removeStyle:t.removeStyle,element:t.element};i.click(e,a),o.remove(),u(e,t)}))}(e,t)},u=function(e,t){if(!1===e.range)t.element.disabled=!0,t.element.classList.remove("active");else if("CLEAR"==t.tag)t.element.disabled=!1,t.element.classList.remove("active");else{t.element.disabled="DIV"===e.range.rootNode.tagName||a.nq(e.range.rootNode)||a.UK(e.range.rootNode);var n="",r=e.range.startContainer.parentNode.getAttribute("style");null!=r&&r.split(";").forEach((function(e){if(""!==e){var r=e.split(":");r[0].trim()===t.style&&(n=r[1].trim(),t.element.querySelector("span.bar").setAttribute("style","background-color:".concat(n,";")))}})),""==n&&t.element.querySelector("span.bar").removeAttribute("style")}},d=function(e,t){var n=document.createElement("span");n.classList.add("bar"),n.classList.add(t.tag),t.element.appendChild(n),t.element.classList.add("barred")};r={init:d,setState:u,style:"color",removeStyle:"color:black;"};var f=new s.Z("inline","FGC","Foreground colour",l.El,c,r);r={init:d,setState:u,style:"background-color",removeStyle:"background-color:white;"};var p=new s.Z("inline","BGC","Background colour",l.si,c,r)},827:(e,t,n)=>{n.r(t),n.d(t,{BUTTON:()=>v});var r,o,a=n(135),i=n(92),l=n(333),s=n(208),c="CUSTOM",u=null;function d(e,t,n){u||(r=n,f(e,t,!0))}function f(e,t,n){0==n&&((r=document.createElement(c)).id=l.y_(),r.setAttribute("contenteditable","false"),r.innerHTML=h({property1:" ",property2:" ",property3:" "})),(u=document.createElement("DIV")).id="custom-edit",u.classList.add("edit-panel");var i={property1:r.querySelector(".property1").innerText,property2:r.querySelector(".property2").innerText,property3:r.querySelector(".property3").innerText};u.innerHTML=function(e,t){var n="Create custom element",r="";return t&&(n="Edit custom element",r='<button type="button" class="delete">Delete</button>'),'\n        <div class="edit-panel-container">\n            <div class="edit-panel-header">\n                <h3 class="edit-panel-title">'.concat(n,'</h3>\n            </div>\n            <div class="edit-panel-body">\n                <form>\n                    <div class="form-input">\n                        <label for="property1">Property 1</label>\n                        <input id="property1" type="text" class="form-control" placeholder="Property 1" required value="').concat(e.property1,'">\n                    </div>\n                    <div class="form-input">\n                        <label for="property2">Property 2</label>\n                        <input id="property2" type="text" class="form-control" placeholder="Property 2" required value="').concat(e.property2,'">\n                    </div>\n                    <div class="form-input">\n                        <label for="property3">Property 3</label>\n                        <input id="property3" type="text" class="form-control" placeholder="Property 3" required value="').concat(e.property3,'">\n                    </div>\n                    <div class="buttons">\n                        <button type="button" class="cancel">Cancel</button>\n                        ').concat(r,'\n                        <button type="submit" class="save">Save</button>\n                    </div>\n                </form>\n            </div>\n        </div>')}(i,n),o=!1,u.querySelectorAll("form input").forEach((function(e){return e.addEventListener("change",(function(){return o=!0}))})),u.querySelector("button.cancel").addEventListener("click",(function(){o?a.$("Cancel changes","Do you really want to lose these changes?").addEventListener("click",(function(){a.C(),p()})):p()})),n&&u.querySelector("button.delete").addEventListener("click",(function(){a.$("Delete custom item","Do you really want to delete this custom item?","No - keep","Yes - delete").addEventListener("click",(function(){a.C(),function(e,t){r.remove(),p(),e.range=!1,g(e,t)}(e,t)}))})),u.querySelector("form").addEventListener("submit",(function(o){o.preventDefault(),function(e,t,n){r.querySelector(".property1").innerText=u.querySelector("form #property1").value.trim(),r.querySelector(".property2").innerText=u.querySelector("form #property2").value.trim(),r.querySelector(".property3").innerText=u.querySelector("form #property3").value.trim(),0==n&&function(e){r=e.range.startContainer.parentNode.appendChild(r)}(e),b(e,t,r),p(),e.range=l.KJ(r,0),g(e,t)}(e,t,n)})),document.querySelector("body").appendChild(u);var s=u.querySelector("form #property1");s.focus(),s.setSelectionRange(s.value.length,s.value.length),setTimeout((function(){return u.classList.add("show")}),10)}function p(){u.classList.remove("show"),setTimeout((function(){u.remove(),u=null}),500)}function b(e,t,n){n.id,0==n.id&&(n.id=l.y_());var r={property1:n.querySelector(".property1").innerText,property2:n.querySelector(".property2").innerText,property3:n.querySelector(".property3").innerText};n.innerHTML=h(r),n.setAttribute("contenteditable",!1);var o=document.createElement("button");o.type="button",o.classList.add("edit"),o.innerText="Edit",o.addEventListener("click",(function(r){r.preventDefault(),r.stopPropagation(),d(e,t,n)})),n.appendChild(o),n.addEventListener("click",(function(){g(e,t)}))}function h(e){return'\n        <span class="title">I am a custom object with 3 properties:</span>\n        <span class="label">Property 1:</span><span class="prop property1">'.concat(e.property1,'</span>\n        <span class="label">Property 2:</span><span class="prop property2">').concat(e.property2,'</span>\n        <span class="label">Property 3:</span><span class="prop property3">').concat(e.property3,'</span>\n        <span class="advice">Click the top right-hand button to edit. Select anywhere in the element and then the Enter key to add a new line after this custom element.</span>\n    ')}var g=function(e,t){!1===e.range||0==e.range.collapsed&&e.range.startContainer!=e.range.endContainer?(t.element.disabled=!0,t.element.classList.remove("active")):(t.element.disabled=!1,null!=e.range.blockParent.querySelector(c)?t.element.classList.add("active"):t.element.classList.remove("active"))},m={setState:g,init:function(e,t){e.editorNode.querySelectorAll(c).forEach((function(n){return b(e,t,n)}))},addEventHandlers:function(e){e.editorNode.querySelectorAll(c+" button").forEach((function(t){return t.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation();var r=t.parentNode;d(e,v,r)}))}))},clean:function(e){return console.log("clean custom element",e),e.removeAttribute("contenteditable"),e.querySelector(".title").remove(),e.querySelector(".advice").remove(),e.querySelector(".label").remove(),e.querySelector("button").remove(),e}},v=new s.Z("custom",c,"Custom",i.BA,(function(e,t){var n=e.range.blockParent.querySelector(c);null!=n?d(e,t,n):f(e,t,!1)}),m)},537:(e,t,n)=>{n.r(t),n.d(t,{BUTTON:()=>m});var r,o,a=n(135),i=n(208),l=n(92),s=n(333),c="A",u=null;function d(e,t,n){u||(r=n,f(e,t,"",!0))}function f(e,t,n,i){0==i&&((r=document.createElement(c)).id=s.y_(),r.setAttribute("contenteditable","false"),r.href="",r.dataset.label=n,r.dataset.display=0),(u=document.createElement("DIV")).id="link-edit",u.classList.add("edit-panel"),u.innerHTML=function(e){var t="Create link",n="",o="",a="http://",i=r.dataset.label,s=r.dataset.display?r.dataset.display:0;return e&&(t="Edit link",a=r.href,n='<button type="button" class="delete">Delete</button>',o='<a href="'.concat(a,'" class="panel-link" target="_blank" title="Open link in new tab or window">').concat(l.nG,"</a>")),'\n        <div class="edit-panel-container">\n            <div class="edit-panel-header">\n                <h3 class="edit-panel-title">'.concat(t,'</h3>\n            </div>\n            <div class="edit-panel-body">\n                <form>\n                    <div class="form-input">\n                        <label for="href">URL</label>\n                        <input id="href" type="url" class="form-control ').concat(o?"with-button":"",'" placeholder="URL" required value="').concat(a,'">\n                        ').concat(o,'\n                    </div>\n                    <div class="form-input">\n                        <label for="label">Label (optional)</label>\n                        <input id="label" type="text" class="form-control" placeholder="Label" value="').concat(i,'">\n                    </div>\n                    <div class="form-input">\n                        <label for="label">Display option</label>\n                        <select class="form-control" id="display">\n                            <option value="0" ').concat(0==s?"selected":"",'>Label only</option>\n                            <option value="1" ').concat(1==s?"selected":"",'>Link only</option>\n                            <option value="2" ').concat(2==s?"selected":"",'>Label and link</option>\n                        </select>\n                    </div>\n                    <div class="buttons">\n                        <button type="button" class="cancel">Cancel</button>\n                        ').concat(n,'\n                        <button type="submit" class="save">Save</button>\n                    </div>\n                </form>\n            </div>\n        </div>')}(i),o=!1,u.querySelectorAll("form input").forEach((function(e){return e.addEventListener("change",(function(){return o=!0}))})),u.querySelector("button.cancel").addEventListener("click",(function(){o?a.$("Cancel changes","Do you really want to lose these changes?").addEventListener("click",(function(){a.C(),p()})):p()})),i&&u.querySelector("button.delete").addEventListener("click",(function(){a.$("Delete link","Do you really want to delete this link?").addEventListener("click",(function(){a.C(),function(e,t){r.remove(),p(),e.range=!1,h(e,t)}(e,t)}))})),u.querySelector("form").addEventListener("submit",(function(n){n.preventDefault(),function(e,t,n){r.href=u.querySelector("form #href").value.trim(),r.dataset.label=u.querySelector("form #label").value.trim(),r.dataset.display=parseInt(u.querySelector("form #display").value),0==n&&function(e){var t,n=e.range.startContainer.parentNode,o=e.range.startContainer.textContent.substring(0,e.range.startOffset);e.range.collapsed?(t=e.range.startContainer.textContent.substring(e.range.startOffset)," "!=o.charAt(o.length+1)&&(o+=" ")," "!=t.charAt(0)&&(t=" "+t)):t=e.range.startContainer.textContent.substring(e.range.endOffset),o&&n.insertBefore(document.createTextNode(o),e.range.startContainer),r=n.insertBefore(r,e.range.startContainer),t&&n.insertBefore(document.createTextNode(t),e.range.startContainer),e.range.startContainer.remove()}(e),b(e,t,r),p(),e.range=s.KJ(r,0),h(e,t)}(e,t,i)})),document.querySelector("body").appendChild(u);var d=u.querySelector("form #href");d.focus(),d.setSelectionRange(d.value.length,d.value.length),setTimeout((function(){return u.classList.add("show")}),10)}function p(){u.classList.remove("show"),setTimeout((function(){u.remove(),u=null}),500)}function b(e,t,n){0==n.id&&(n.id=s.y_()),n.setAttribute("contenteditable",!1),n.title="Click to edit",n.innerText=function(e){switch(parseInt(e.dataset.display)){case 0:if(e.dataset.label)return e.dataset.label;break;case 1:return e.href;case 2:if(e.dataset.label&&e.dataset.label!=e.href)return"".concat(e.dataset.label," (").concat(e.href,")")}return e.href}(n),n.addEventListener("click",(function(r){r.preventDefault(),r.stopPropagation(),d(e,t,n)}))}var h=function(e,t){!1===e.range||0==e.range.collapsed&&e.range.startContainer!=e.range.endContainer?(t.element.disabled=!0,t.element.classList.remove("active")):(t.element.disabled=!1,null!=e.range.blockParent.querySelector(c)?t.element.classList.add("active"):t.element.classList.remove("active"))},g={init:function(e,t){e.editorNode.querySelectorAll(c).forEach((function(n){return b(e,t,n)}))},setState:h,addEventHandlers:function(e){e.editorNode.querySelectorAll(c).forEach((function(t){return t.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation(),d(e,m,t)}))}))},clean:function(e){return console.log("clean link",e),e.removeAttribute("id"),e.removeAttribute("contenteditable"),e.innerText=" ",e}},m=new i.Z("custom",c,"Link",l.p4,(function(e,t){if(console.log("click link"),!1!==e.range){var n="";0==e.range.collapsed&&e.range.startContainer==e.range.endContainer&&(n=e.range.endContainer.textContent.substring(e.range.startOffset,e.range.endOffset)),f(e,t,n,!1)}else console.log("No range selected")}),g)},30:(e,t,n)=>{n.r(t),n.d(t,{setup:()=>p,BUTTON:()=>b});var r,o=n(208),a=n(92),i=n(333),l="",s=null,c="",u="";function d(){s.remove(),s=null}function f(e){var t=r.range.startContainer.textContent,n=r.range.startOffset,o=t.substring(0,n),a=t.substring(n);"@"===a.charAt(0)&&(a=a.slice(1,a.length-1)),32!==t.charCodeAt(n-1)&&(e=" "+e),n<t.length&&32!==t.charCodeAt(n)&&(""!=a&&(a+=" "),e+=" "),r.range.startContainer.textContent=o+e+a,n+=e.length,r.range=(0,i.KJ)(r.range.startContainer,n),d(),r.bufferUpdate(r)}var p=function(e){e=e.sort(),l="",e.forEach((function(e){l+="<option>".concat(e,"</option>")}))},b=new o.Z("custom","mention","Mention",a.lB,(function(e,t){if(!1!==e.range){r=e,(s=document.createElement("DIV")).id="mentions",s.classList.add("inplace-panel"),s.innerHTML='\n        <div class="inplace-content">\n            <input list="people-list" type="text"/>\n            <datalist id="people-list">'.concat(l,"</datalist>\n        </div>"),(c=s.querySelector("input")).addEventListener("keyup",(function(e){return function(e){e.stopPropagation(),"Escape"==e.key?d():"Enter"==e.key&&f(c.value.trim())}(e)})),u="",c.addEventListener("input",(function(e){var t=c.value.trim();t.length-u.length>1&&f(t),u=t})),document.querySelector("body").appendChild(s);var n=document.querySelector(".inplace-content"),o=function(e){var t;return(t=3!==r.range.startContainer.nodeType?r.range.startContainer.childNodes.length>0?r.range.startContainer.childNodes[0].getBoundingClientRect():{x:r.editorNode.offsetLeft,y:r.editorNode.offsetTop}:r.range.getBoundingClientRect()).x+e.outerWidth>window.innerWidth&&(t.x=window.innerWidth-e.outerWidth-20),t.y+e.outerHeight>window.innerHeight&&(t.y=window.innerHeight-e.outerHeight-40),t}(n);n.style.top="".concat(o.y,"px"),n.style.left="".concat(o.x,"px"),c.focus()}else console.log("No range selected")}),{setState:function(e,t){!1===e.range||0==e.range.collapsed&&e.range.startContainer!=e.range.endContainer?(t.element.disabled=!0,t.element.classList.remove("active")):(t.element.disabled=!1,t.element.classList.add("active"))},shortcut:["@","Tab"]})},178:(e,t,n)=>{n.r(t),n.d(t,{click:()=>y,B:()=>C,I:()=>E,U:()=>L,CLEAR:()=>S});var r,o,a,i,l,s,c,u=n(208),d=n(333),f=n(92),p=n(124);function b(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e){var t=e.split(":");o=t[0],i=void 0!==t[1]?t[1]:""}function m(e,t){return console.log("Parsing node",e),3===e.nodeType?function(e,t){p.t8(e);var n="",a="";if(p.Q9())if("apply"==c){var s=-1;t.forEach((function(e,t){e.split(":")[0].trim()==o&&(s=t)})),-1!=s&&(t=t.filter((function(e,t){return t!=s})));var u="".concat(o,":").concat(i);t=[].concat(b(t),[u]),n='<span style="'.concat(t.join(";"),'">'),a="</span>"}else"CLEAR"!=o&&(t=t.filter((function(e){return e.split(":")[0].trim()!=o}))).length>0&&(n='<span style="'.concat(t.join(";"),";").concat(l,'">'),a="</span>");else t.length>0&&(n='<span style="'.concat(t.join(";"),'">'),a="</span>");return p.hF()||p.v_()?n+e.textContent+a:p.Hk()?e.textContent.substring(0,r.startOffset)+n+(d.E+e.textContent.substring(r.startOffset,r.endOffset)+d.Kj)+a+e.textContent.substring(r.endOffset):p.Ps()?e.textContent.substring(0,r.startOffset)+n+(d.E+e.textContent.substring(r.startOffset))+a:p.Z$()?n+(e.textContent.substring(0,r.endOffset)+d.Kj)+a+e.textContent.substring(r.endOffset):p.Q9()?n+e.textContent+a:(console.warn("Error: Found a missing state with node",e),"")}(e,t):d.UK(e)?e.outerHTML:function(e,t){if("SPAN"===e.tagName){var n=e.getAttribute("style");null!=n&&""!=n&&n.split(";").forEach((function(e){if(""!=e){var n=e.split(":");0==t.includes(n[0].trim())&&(t=[].concat(b(t),[e]))}}))}var r="";return e.childNodes.forEach((function(e){r+=m(e,t)})),console.log("Returning block html",r),r}(e,t)}var v=function(e,t){!1===e.range||0==e.range.collapsed&&e.range.startContainer!=e.range.endContainer?(t.element.disabled=!0,t.element.classList.remove("active")):"CLEAR"==t.tag?(t.element.disabled=!1,t.element.classList.remove("active")):(t.element.disabled="DIV"===e.range.rootNode.tagName||d.nq(e.range.rootNode)||d.UK(e.range.rootNode),g(t.style),d.kg(e.range.startContainer).includes(t.style)?t.element.classList.add("active"):t.element.classList.remove("active"))},y=function(e,t){r=e.range,l=(a=t).removeStyle,0==d.Lq(r.rootNode)&&(r.rootNode=d.H_(r.rootNode)),g(a.style),c="apply",(a.element.classList.contains("active")||"CLEAR"==o)&&(c="remove"),p.S1(r,!1);var n=m(r.rootNode,[]);console.log("html",n),d.$H(r.rootNode,r.rootNode.tagName,n),d.Mt(e.editorNode),e.updateRange(),a.setState(e,a)};s={setState:v,style:"font-weight:bold",removeStyle:"font-weight:400"};var C=new u.Z("style","B","Bold",f.b,y,s);s={setState:v,style:"font-style:italic",removeStyle:"font-style:normal"};var E=new u.Z("style","I","Italic",f.i,y,s);s={setState:v,style:"text-decoration:underline",removeStyle:"text-decoration:none"};var L=new u.Z("style","U","Underline",f.u,y,s);s={setState:v,style:"CLEAR"};var S=new u.Z("style","CLEAR","Clear",f.ZH,y,s)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{n.r(r),n.d(r,{Editor:()=>e,Blocks:()=>t,Styles:()=>o,Mentions:()=>a,Links:()=>s,Buffer:()=>i,Colours:()=>l,Custom:()=>c});var e=n(250).Z,t=n(326),o=n(178),a=n(30),i=n(609),l=n(626),s=n(537),c=n(827)})(),r})()}));